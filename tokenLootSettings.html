<style>
    .token-loot-settings-container {
        display: grid;
        grid-template-columns: 120px 120px 120px 120px;
        gap: 10px;
        max-width: 600px;
        margin: 0 auto;
        padding: 10px;
        box-sizing: border-box;
    }

    .compendium-select-btn, .rarity-select {
        width: 100%;
        text-align: left;
        padding: 8px 12px;
        font-size: 14px;
        border: 1px solid #999;
        background-color: #333;
        color: white;
        cursor: pointer;
        border-radius: 5px;
        transition: background 0.2s ease-in-out;
        min-height: 36px;
        box-sizing: border-box;
    }

    .compendium-select-btn:hover, .rarity-select:hover {
        background-color: #040404;
    }

    .compendium-select-btn.custom, .rarity-select.custom {
        background-color: #27ae60;
    }

    .compendium-select-btn.custom:hover, .rarity-select.custom:hover {
        background-color: #145c32;
    }

    .token-loot-settings-window {
        min-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
    }

    .header-label {
        font-weight: bold;
        text-align: center;
    }

    .quantity-input, .item-chance-input, .currency-chance-input {
        width: 100%;
        padding: 4px;
        border-radius: 5px;
        background-color: #333;
        color: white;
        border: 1px solid #999;
        box-sizing: border-box;
        font-weight: bold;
    }

    .quantity-input::placeholder, .item-chance-input::placeholder, .currency-chance-input::placeholder {
        color: #888;
        font-style: italic;
        font-weight: normal;
    }

    .rarity-select {
        width: 100%;
        padding: 4px;
        border-radius: 5px;
        background-color: #333;
        color: white;
        border: 1px solid #999;
        box-sizing: border-box;
    }

    input:disabled {
        background-color: #555;
        color: #888;
        cursor: not-allowed;
    }

    .sources-row {
        grid-column: 1 / -1;
        margin-top: 10px;
    }
</style>

<form class="token-loot-settings-container" autocomplete="off" onsubmit="event.preventDefault();">
    <span class="header-label">Item Quantity</span>
    <span class="header-label">Item Chance</span>
    <span class="header-label">Coin Chance</span>
    <span class="header-label">Max Rarity</span>
    
    <input type="text" class="quantity-input" value="{{quantityFormula}}" placeholder="{{globalQuantityFormula}}" title="Loot Quantity Formula">
    <input type="number" class="item-chance-input" value="{{itemChance}}" min="0" max="100" placeholder="{{globalItemChance}}" title="Item Chance (%)">
    <input type="number" class="currency-chance-input" value="{{currencyChance}}" min="0" max="100" placeholder="{{globalCurrencyChance}}" title="Currency Chance (%)">
    <select class="rarity-select {{#if maxRarity}}custom{{/if}}">
        <option value="" {{#unless maxRarity}}selected{{/unless}}>[Default Rarity]</option>
        <option value="Common" {{#if (eq maxRarity "Common")}}selected{{/if}}>Common</option>
        <option value="Uncommon" {{#if (eq maxRarity "Uncommon")}}selected{{/if}}>Uncommon</option>
        <option value="Rare" {{#if (eq maxRarity "Rare")}}selected{{/if}}>Rare</option>
        <option value="Very Rare" {{#if (eq maxRarity "Very Rare")}}selected{{/if}}>Very Rare</option>
        <option value="Legendary" {{#if (eq maxRarity "Legendary")}}selected{{/if}}>Legendary</option>
    </select>
    
    <div class="sources-row">
        <button type="button" class="compendium-select-btn {{#if (gt totalSources 0)}}custom{{/if}}">{{#if (gt totalSources 0)}}Custom [{{totalSources}}]{{else}}[Default Sources]{{/if}}</button>
    </div>
</form>